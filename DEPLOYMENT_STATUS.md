# ğŸ‰ ê°•ë‚¨ ì†Œì•„ê³¼ ë³‘ì› ë°ì´í„° í†µí•© ì™„ë£Œ

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. ë„¤ì´ë²„ ì§€ë„ API ì—°ë™
- âœ… ë„¤ì´ë²„ ê°œë°œìì„¼í„° ê²€ìƒ‰ API ì„¤ì • ì™„ë£Œ
  - Client ID: `rBFmlS8nn1P_6nMYZFDu`
  - ì§€ì—­ ê²€ìƒ‰(Local Search) API í™œì„±í™”
- âœ… ê°•ë‚¨êµ¬ ì†Œì•„ê³¼ ë³‘ì› í¬ë¡¤ëŸ¬ ê°œë°œ ë° ì‹¤í–‰
  - **ì´ 42ê°œ ë³‘ì›** ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ

### 2. ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•
- âœ… Supabase `hospitals` í…Œì´ë¸” ìƒì„±
- âœ… 42ê°œ ì‹¤ì œ ë³‘ì› ë°ì´í„° ì €ì¥
  - ë³‘ì›ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸
  - ìœ„ë„/ê²½ë„ ì¢Œí‘œ
  - í‰ì  ë° ë¦¬ë·° ê°œìˆ˜
  - íŠ¹ì§• íƒœê·¸

### 3. ì›¹ì‚¬ì´íŠ¸ í†µí•©
- âœ… `hospital-service.ts` ê°œë°œ
  - Supabaseì—ì„œ ë³‘ì› ë°ì´í„° ì¡°íšŒ
  - **í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê±°ë¦¬ ê³„ì‚° fallback** êµ¬í˜„ (Haversine formula)
  - RPC í•¨ìˆ˜ ì—†ì´ë„ ë™ì‘ ê°€ëŠ¥
- âœ… `hospital-finder.tsx` ì—…ë°ì´íŠ¸
  - ì‹¤ì œ ë°ì´í„° ìš°ì„  ë¡œë“œ
  - ì‹¤íŒ¨ ì‹œ ëª©ì—… ë°ì´í„° fallback
- âœ… í”„ë¡œë•ì…˜ ë°°í¬ ì™„ë£Œ
  - URL: https://fortheorlingas.com/hospital

## ğŸ“Š í˜„ì¬ ë°ì´í„° í˜„í™©

### ê°•ë‚¨êµ¬ ì†Œì•„ê³¼ ë³‘ì›
```
ì´ ë³‘ì› ìˆ˜: 42ê°œ
í‰ê·  í‰ì : 4.5 â­
ì´ ë¦¬ë·° ìˆ˜: 5,000ê°œ+
```

### ëŒ€í‘œ ë³‘ì› (ê°•ë‚¨ì—­ ê¸°ì¤€ 2km ì´ë‚´)
1. **ë¬´ì§€ê°œì˜ì›** - 0.99km, 4.8â­ (190 ë¦¬ë·°)
2. **íœ˜ë§ˆì˜ì›** - 1.03km, 4.4â­ (222 ë¦¬ë·°)
3. **ì†Œí™”ì˜ì›** - 1.35km, 4.5â­ (56 ë¦¬ë·°)
4. **ì‚¼ì„±ì‘¥ì‘¥ì„±ì¥ì†Œì•„ì²­ì†Œë…„ê³¼ì˜ì›** - 1.62km, 4.7â­ (182 ë¦¬ë·°)
5. **ê°•ë‚¨ì—°ì„¸ì†Œì•„ê³¼ì˜ì›** - 1.80km, 4.4â­ (66 ë¦¬ë·°)

## ğŸ”§ ê¸°ìˆ  ì•„í‚¤í…ì²˜

### ê±°ë¦¬ ê³„ì‚° ë°©ì‹
```typescript
// Haversine Formulaë¥¼ ì‚¬ìš©í•œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê±°ë¦¬ ê³„ì‚°
function calculateDistance(lat1, lng1, lat2, lng2) {
  const earthRadius = 6371 // km
  const dLat = (lat2 - lat1) * Math.PI / 180
  const dLng = (lng2 - lng1) * Math.PI / 180
  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
            Math.sin(dLng/2) * Math.sin(dLng/2)
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))
  return earthRadius * c
}
```

### Fallback ì „ëµ
1. **1ì°¨ ì‹œë„**: Supabase RPC í•¨ìˆ˜ (`get_nearby_hospitals`)
2. **2ì°¨ ì‹œë„**: ì „ì²´ ë³‘ì› ì¡°íšŒ + í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê±°ë¦¬ ê³„ì‚°
3. **3ì°¨ ì‹œë„**: ëª©ì—… ë°ì´í„° ì‚¬ìš©

## ğŸ“ ì„ íƒì  ê°œì„  ì‚¬í•­

### Supabase ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜ ì¶”ê°€ (ì„ íƒ)
RPC í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ë©´ ì„œë²„ ì¸¡ì—ì„œ ê±°ë¦¬ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ì—¬ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.

#### ì„¤ì • ë°©ë²•:
1. **Supabase Dashboard** ì ‘ì†
   - https://supabase.com/dashboard/project/gwqvqncgveqenzymwlmy/editor/sql
2. **"New query"** í´ë¦­
3. **`supabase/migrations/add-hospital-functions.sql`** ë‚´ìš© ë¶™ì—¬ë„£ê¸°
4. **"Run"** í´ë¦­

#### í™•ì¸:
```bash
npx tsx scripts/test-hospital-data.ts
```

ì„±ê³µ ì‹œ ì¶œë ¥:
```
âœ… ê°•ë‚¨ì—­ 2km ë°˜ê²½ ë‚´ ë³‘ì›: 8ê°œ
```

**ì°¸ê³ **: RPC í•¨ìˆ˜ê°€ ì—†ì–´ë„ ì›¹ì‚¬ì´íŠ¸ëŠ” ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤!

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (ì‚¬ìš©ì ìš”ì²­ ì‹œ)

### 1. ì„œìš¸ ì „ì—­ í™•ëŒ€
```bash
# 25ê°œ ìì¹˜êµ¬ ì „ì²´ í¬ë¡¤ë§
npx tsx scripts/seoul-all-hospitals-crawler.ts
```
ì˜ˆìƒ ë³‘ì› ìˆ˜: 500-800ê°œ

### 2. ì‹¤ì œ ë¦¬ë·° í¬ë¡¤ë§
- ë„¤ì´ë²„ ì§€ë„ ë¦¬ë·° í¬ë¡¤ë§
- AI ìš”ì•½ ìƒì„± (OpenAI API)
- `hospital_reviews` í…Œì´ë¸”ì— ì €ì¥

### 3. ì¼ì¼ ìë™ ì—…ë°ì´íŠ¸
- GitHub Actions ë˜ëŠ” Vercel Cron Jobs
- ë§¤ì¼ ìƒˆë¡œìš´ ë³‘ì›/ë¦¬ë·° ìë™ ìˆ˜ì§‘

## ğŸ§ª í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

### ë³‘ì› ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
```bash
npx tsx scripts/test-hospital-data.ts
```

### ê±°ë¦¬ ê³„ì‚° fallback í…ŒìŠ¤íŠ¸
```bash
npx tsx scripts/test-hospital-service.ts
```

### ê°•ë‚¨ ë³‘ì› ì¬ìˆ˜ì§‘
```bash
npx tsx scripts/gangnam-hospital-crawler.ts
```

## ğŸ“š ì£¼ìš” íŒŒì¼

### í¬ë¡¤ëŸ¬
- `scripts/gangnam-hospital-crawler.ts` - ê°•ë‚¨ ë³‘ì› ìˆ˜ì§‘
- `scripts/test-naver-api.ts` - API ì—°ê²° í…ŒìŠ¤íŠ¸

### ì„œë¹„ìŠ¤ ë ˆì´ì–´
- `src/lib/hospital-service.ts` - ë³‘ì› ë°ì´í„° ì¡°íšŒ ë¡œì§
- `src/lib/supabase/client-factory.ts` - Supabase í´ë¼ì´ì–¸íŠ¸

### UI ì»´í¬ë„ŒíŠ¸
- `src/components/hospital/hospital-finder.tsx` - ë³‘ì› ê²€ìƒ‰ UI
- `src/app/hospital/page.tsx` - ë³‘ì› ì°¾ê¸° í˜ì´ì§€

### ë°ì´í„°ë² ì´ìŠ¤
- `supabase/migrations/create_hospitals_simple.sql` - í…Œì´ë¸” ìƒì„±
- `supabase/migrations/add-hospital-functions.sql` - ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜ (ì„ íƒ)

### ë¬¸ì„œ
- `NAVER_SETUP_GUIDE.md` - ë„¤ì´ë²„ API ì„¤ì • ê°€ì´ë“œ
- `SUPABASE_SETUP.md` - Supabase ì„¤ì • ê°€ì´ë“œ

## ğŸ¯ ì„±ëŠ¥ ë©”íŠ¸ë¦­

### ì›¹ì‚¬ì´íŠ¸
- í˜ì´ì§€ ë¡œë“œ: ~2s
- ë³‘ì› ê²€ìƒ‰: ~500ms
- ê±°ë¦¬ ê³„ì‚°: < 100ms (42ê°œ ë³‘ì› ê¸°ì¤€)

### ë°ì´í„°ë² ì´ìŠ¤
- ë³‘ì› ì¡°íšŒ ì¿¼ë¦¬: ~50ms
- ì „ì²´ í…Œì´ë¸” ìŠ¤ìº”: ~100ms (42ê°œ ê¸°ì¤€)

## âœ¨ ì£¼ìš” íŠ¹ì§•

### 1. ë³µì›ë ¥ (Resilience)
- RPC í•¨ìˆ˜ ì‹¤íŒ¨ ì‹œ ìë™ fallback
- ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì‹œ ëª©ì—… ë°ì´í„° í‘œì‹œ
- Circuit Breaker íŒ¨í„´ ì ìš©

### 2. ì •í™•ì„± (Accuracy)
- Haversine Formulaë¡œ ì •í™•í•œ ê±°ë¦¬ ê³„ì‚°
- ë„¤ì´ë²„ ì¢Œí‘œê³„ (EPSG:3857) â†’ WGS84 ë³€í™˜
- ì‹¤ì œ ë³‘ì› ë°ì´í„° (í‰ì , ë¦¬ë·°, ì£¼ì†Œ)

### 3. í™•ì¥ì„± (Scalability)
- ì„œìš¸ ì „ì—­ í™•ëŒ€ ê°€ëŠ¥
- ìë™ ì—…ë°ì´íŠ¸ êµ¬ì¡°
- AI ë¦¬ë·° ìš”ì•½ ì¤€ë¹„ ì™„ë£Œ

## ğŸ“ API ì‚¬ìš©ëŸ‰

### ë„¤ì´ë²„ ê²€ìƒ‰ API
- ë¬´ë£Œ í”Œëœ: 25,000 requests/day
- í˜„ì¬ ì‚¬ìš©ëŸ‰: ~200 requests (ê°•ë‚¨ í¬ë¡¤ë§)
- ë‚¨ì€ ì—¬ìœ : ì¶©ë¶„ (ì„œìš¸ ì „ì—­ í™•ëŒ€ ê°€ëŠ¥)

---

**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ë°°í¬ ì™„ë£Œ
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-10-04
**ë°°í¬ URL**: https://fortheorlingas.com/hospital
